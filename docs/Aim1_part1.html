<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.353">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>zfBrainAsymmetry - The parapineal ‘cell type’ - Part 1</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>


<link rel="stylesheet" href="styles.css">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a class="navbar-brand" href="./index.html">
    <span class="navbar-title">zfBrainAsymmetry</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="./index.html" rel="" target="">
 <span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./session.html" rel="" target="">
 <span class="menu-text">Session</span></a>
  </li>  
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-aims" role="button" data-bs-toggle="dropdown" aria-expanded="false" rel="" target="">
 <span class="menu-text">Aims</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-aims">    
        <li>
    <a class="dropdown-item" href="./Aim1_part1.html" rel="" target="">
 <span class="dropdown-text">The parapineal ‘cell type’ - Part 1</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./Aim1_part2.html" rel="" target="">
 <span class="dropdown-text">The parapineal ‘cell type’ - Part 2</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./Aim2.html" rel="" target="">
 <span class="dropdown-text">The sox1a ‘phenotype’</span></a>
  </li>  
    </ul>
  </li>
</ul>
            <div class="quarto-navbar-tools ms-auto">
</div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#identification-of-epiphysis-cells" id="toc-identification-of-epiphysis-cells" class="nav-link active" data-scroll-target="#identification-of-epiphysis-cells"><span class="header-section-number">1</span> Identification of epiphysis cells</a>
  <ul class="collapse">
  <li><a href="#premise" id="toc-premise" class="nav-link" data-scroll-target="#premise"><span class="header-section-number">1.1</span> <strong>Premise</strong></a></li>
  <li><a href="#experimental-design" id="toc-experimental-design" class="nav-link" data-scroll-target="#experimental-design"><span class="header-section-number">1.2</span> Experimental design</a></li>
  <li><a href="#initialise-r-environment" id="toc-initialise-r-environment" class="nav-link" data-scroll-target="#initialise-r-environment"><span class="header-section-number">1.3</span> Initialise R environment</a></li>
  <li><a href="#pre-processing-of-reads" id="toc-pre-processing-of-reads" class="nav-link" data-scroll-target="#pre-processing-of-reads"><span class="header-section-number">1.4</span> Pre-processing of reads</a></li>
  </ul></li>
  <li><a href="#scrna-seq-analysis-in-seurat" id="toc-scrna-seq-analysis-in-seurat" class="nav-link" data-scroll-target="#scrna-seq-analysis-in-seurat"><span class="header-section-number">2</span> scRNA-seq analysis in <code>Seurat</code></a>
  <ul class="collapse">
  <li><a href="#load-cell-x-gene-matrices" id="toc-load-cell-x-gene-matrices" class="nav-link" data-scroll-target="#load-cell-x-gene-matrices"><span class="header-section-number">2.1</span> Load cell x gene matrices</a></li>
  <li><a href="#filter-genes" id="toc-filter-genes" class="nav-link" data-scroll-target="#filter-genes"><span class="header-section-number">2.2</span> Filter genes</a></li>
  <li><a href="#compute-additional-metrics---percent.mito-ribo-complexity" id="toc-compute-additional-metrics---percent.mito-ribo-complexity" class="nav-link" data-scroll-target="#compute-additional-metrics---percent.mito-ribo-complexity"><span class="header-section-number">2.3</span> Compute additional metrics - percent.mito, ribo, complexity</a></li>
  <li><a href="#compute-cell-cycle-scores" id="toc-compute-cell-cycle-scores" class="nav-link" data-scroll-target="#compute-cell-cycle-scores"><span class="header-section-number">2.4</span> Compute cell cycle scores</a></li>
  <li><a href="#cell-filtering" id="toc-cell-filtering" class="nav-link" data-scroll-target="#cell-filtering"><span class="header-section-number">2.5</span> Cell filtering?</a></li>
  </ul></li>
  <li><a href="#dimensional-reductionclustering" id="toc-dimensional-reductionclustering" class="nav-link" data-scroll-target="#dimensional-reductionclustering"><span class="header-section-number">3</span> Dimensional reduction/clustering</a>
  <ul class="collapse">
  <li><a href="#sctransform-normalise-find-variable-genes-regress-unwanted-variation" id="toc-sctransform-normalise-find-variable-genes-regress-unwanted-variation" class="nav-link" data-scroll-target="#sctransform-normalise-find-variable-genes-regress-unwanted-variation"><span class="header-section-number">3.1</span> SCTransform (‘normalise, find variable genes, regress unwanted variation’)</a></li>
  <li><a href="#unsupervised-clustering" id="toc-unsupervised-clustering" class="nav-link" data-scroll-target="#unsupervised-clustering"><span class="header-section-number">3.2</span> ‘Unsupervised’ Clustering</a></li>
  </ul></li>
  <li><a href="#visualise-and-explore-clustering-results-with-dittoseq" id="toc-visualise-and-explore-clustering-results-with-dittoseq" class="nav-link" data-scroll-target="#visualise-and-explore-clustering-results-with-dittoseq"><span class="header-section-number">4</span> Visualise and explore clustering results with <code>dittoSeq</code></a>
  <ul class="collapse">
  <li><a href="#umap-reduction" id="toc-umap-reduction" class="nav-link" data-scroll-target="#umap-reduction"><span class="header-section-number">4.1</span> UMAP reduction</a></li>
  </ul></li>
  <li><a href="#identify-epiphysis-clusters" id="toc-identify-epiphysis-clusters" class="nav-link" data-scroll-target="#identify-epiphysis-clusters"><span class="header-section-number">5</span> Identify epiphysis clusters</a></li>
  <li><a href="#sanity-checks-on-clustering" id="toc-sanity-checks-on-clustering" class="nav-link" data-scroll-target="#sanity-checks-on-clustering"><span class="header-section-number">6</span> Sanity checks on clustering</a>
  <ul class="collapse">
  <li><a href="#check-distribution-of-multiplets" id="toc-check-distribution-of-multiplets" class="nav-link" data-scroll-target="#check-distribution-of-multiplets"><span class="header-section-number">6.1</span> Check distribution of multiplets</a></li>
  <li><a href="#what-about-other-metrics" id="toc-what-about-other-metrics" class="nav-link" data-scroll-target="#what-about-other-metrics"><span class="header-section-number">6.2</span> What about other metrics?</a></li>
  </ul></li>
  <li><a href="#summary-notes-for-aim-1---part-1" id="toc-summary-notes-for-aim-1---part-1" class="nav-link" data-scroll-target="#summary-notes-for-aim-1---part-1"><span class="header-section-number">7</span> Summary notes for Aim 1 - Part 1</a></li>
  <li><a href="#references" id="toc-references" class="nav-link" data-scroll-target="#references"><span class="header-section-number">8</span> References</a>
  <ul class="collapse">
  <li><a href="#packages" id="toc-packages" class="nav-link" data-scroll-target="#packages"><span class="header-section-number">8.1</span> Packages</a></li>
  <li><a href="#previous-work" id="toc-previous-work" class="nav-link" data-scroll-target="#previous-work"><span class="header-section-number">8.2</span> Previous work</a></li>
  </ul></li>
  <li><a href="#session-info" id="toc-session-info" class="nav-link" data-scroll-target="#session-info"><span class="header-section-number">9</span> Session Info</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">The parapineal ‘cell type’ - Part 1</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<section id="identification-of-epiphysis-cells" class="level2" data-number="1">
<h2 data-number="1" class="anchored" data-anchor-id="identification-of-epiphysis-cells"><span class="header-section-number">1</span> Identification of epiphysis cells</h2>
<section id="premise" class="level3" data-number="1.1">
<h3 data-number="1.1" class="anchored" data-anchor-id="premise"><span class="header-section-number">1.1</span> <strong>Premise</strong></h3>
<p>Using single cell RNA-seq (scRNA-seq), can pineal and parapineal cells be identified from a mixed population regardless of <em>sox1a</em> genotype?</p>
</section>
<section id="experimental-design" class="level3" data-number="1.2">
<h3 data-number="1.2" class="anchored" data-anchor-id="experimental-design"><span class="header-section-number">1.2</span> Experimental design</h3>
<p>Approximately 230 heads from ~30-32 hpf larvae were collected. Larvae were of mixed <em>sox1a</em> genotype (hets, homs and wild types) obtained by incrossing <em>sox1a</em> hets.</p>
<p>Heads were dissociated into single cell suspension for FACS-based enrichment of GFP++/mCherry- cells. GFP labels the epiphysis and other ‘contaminant’ cell types, while mCherry labels ‘contaminant’ cell types only. The mCherry transgene was pre-determined in prior imaging experiments to not label the parapineal organ.</p>
<p>Approximately 10k sorted events were recorded and collected for scRNA-seq using 10X Genomics 3’ v3.1 GEX chemistry. The library was sequenced to at least 500 million reads, thus yielding a depth of ~100k reads per cell.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="./figures/foxd3flh-facs.png" class="img-fluid figure-img"></p>
<figcaption class="figure-caption">Schematic of experiment design.</figcaption>
</figure>
</div>
</section>
<section id="initialise-r-environment" class="level3" data-number="1.3">
<h3 data-number="1.3" class="anchored" data-anchor-id="initialise-r-environment"><span class="header-section-number">1.3</span> Initialise R environment</h3>
<p><a href="./session.html">Session</a></p>
</section>
<section id="pre-processing-of-reads" class="level3" data-number="1.4">
<h3 data-number="1.4" class="anchored" data-anchor-id="pre-processing-of-reads"><span class="header-section-number">1.4</span> Pre-processing of reads</h3>
<p>To empirically determine the robustness of called clusters downstream, reads were pre-processed using two different mapper/gene annotation combinations:</p>
<ul>
<li><p>10X Genomics CellRanger v7.1.0 + Lawson Lab annotation (Lawson <em>et al</em>., 2020)</p>
<ul>
<li><p>This pipeline maps unique reads only:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Preprocessing - Cell Ranger 7.1.0 (unique reads only)</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="ex">cellranger</span> count <span class="at">--id</span><span class="op">=</span>foxd3flhGFP <span class="dt">\</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>--transcriptome=/home/ucbtvmr/Scratch/cellranger/mkref/GRCz11_lawson/GRCz11_v4.3.2_GFP_mCherry <span class="dt">\</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>--fastqs=/home/ucbtvmr/Scratch/4_scRNAseq/fastq <span class="dt">\</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>--sample=VCM2-AK30645-AK6234 <span class="dt">\</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>--no-bam</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div></li>
</ul></li>
<li><p>STARsolo v2.7.10b + Ensembl release 107 annotation</p>
<ul>
<li><p>This pipeline includes multi-mapping reads assigned using EM algorithm:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Preprocessing - STARsolo v2.7.10b (with EM multi-mapped reads)</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="ex">STAR</span> <span class="at">--genomeDir</span> /home/ucbtvmr/ensembl_releases/ensembl107/Danio_rerio.genome.GFP.mCherry/star_2.7.9a <span class="dt">\</span></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>--readFilesIn /home/ucbtvmr/Scratch/4_scRNAseq/fastq/VCM2-AK30645-AK6234<span class="pp">*</span>in progress<span class="pp">**</span>_S1_L002_R2_001.fastq.gz <span class="dt">\</span></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>/home/ucbtvmr/Scratch/4_scRNAseq/fastq/VCM2-AK30645-AK6234_S1_L002_R1_001.fastq.gz <span class="dt">\</span></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>--readFilesCommand zcat <span class="dt">\</span></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>--soloFeatures GeneFull <span class="dt">\</span></span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>--soloMultiMappers EM <span class="dt">\</span></span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>--clipAdapterType CellRanger4 <span class="at">--outFilterScoreMin</span> 30 <span class="dt">\</span></span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a>--soloCBwhitelist 3M-february-2018.txt <span class="dt">\</span></span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a>--soloType CB_UMI_Simple <span class="dt">\</span></span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a>--soloCBlen 16 <span class="dt">\</span></span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a>--soloUMIstart 17 <span class="dt">\</span></span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a>--soloUMIlen 12 <span class="dt">\</span></span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a>--soloBarcodeReadLength 0 <span class="dt">\</span></span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a>--soloCellFilter EmptyDrops_CR <span class="dt">\</span></span>
<span id="cb2-16"><a href="#cb2-16" aria-hidden="true" tabindex="-1"></a>--limitOutSJcollapsed 5000000 <span class="dt">\</span></span>
<span id="cb2-17"><a href="#cb2-17" aria-hidden="true" tabindex="-1"></a>--runThreadN 8</span>
<span id="cb2-18"><a href="#cb2-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-19"><a href="#cb2-19" aria-hidden="true" tabindex="-1"></a><span class="bu">cd</span> /home/ucbtvmr/Scratch/4_scRNAseq/preprocessing/star_2.7.10b/ensembl107/Solo.out/GeneFull</span>
<span id="cb2-20"><a href="#cb2-20" aria-hidden="true" tabindex="-1"></a><span class="fu">mkdir</span> raw_EM</span>
<span id="cb2-21"><a href="#cb2-21" aria-hidden="true" tabindex="-1"></a><span class="bu">cd</span> raw_EM</span>
<span id="cb2-22"><a href="#cb2-22" aria-hidden="true" tabindex="-1"></a><span class="co"># move multimapped-containing matrix to /raw_EM</span></span>
<span id="cb2-23"><a href="#cb2-23" aria-hidden="true" tabindex="-1"></a><span class="fu">mv</span> ../raw/UniqueAndMult-EM.mtx .</span>
<span id="cb2-24"><a href="#cb2-24" aria-hidden="true" tabindex="-1"></a><span class="fu">cp</span> ../raw/features.tsv .</span>
<span id="cb2-25"><a href="#cb2-25" aria-hidden="true" tabindex="-1"></a><span class="fu">cp</span> ../raw/barcodes.tsv .</span>
<span id="cb2-26"><a href="#cb2-26" aria-hidden="true" tabindex="-1"></a><span class="co"># rename multimapped-containing matrix to 'matrix.mtx' for --soloCellFiltering</span></span>
<span id="cb2-27"><a href="#cb2-27" aria-hidden="true" tabindex="-1"></a><span class="fu">mv</span> UniqueAndMult-EM.mtx matrix.mtx</span>
<span id="cb2-28"><a href="#cb2-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-29"><a href="#cb2-29" aria-hidden="true" tabindex="-1"></a><span class="co"># Change working directory to the one containing Aligned.out.sam</span></span>
<span id="cb2-30"><a href="#cb2-30" aria-hidden="true" tabindex="-1"></a><span class="bu">cd</span> /home/ucbtvmr/Scratch/4_scRNAseq/preprocessing/star_2.7.10b/ensembl107</span>
<span id="cb2-31"><a href="#cb2-31" aria-hidden="true" tabindex="-1"></a><span class="co"># Call cells</span></span>
<span id="cb2-32"><a href="#cb2-32" aria-hidden="true" tabindex="-1"></a><span class="ex">STAR</span> <span class="at">--runMode</span> soloCellFiltering ./Solo.out/GeneFull/raw_EM ./Solo.out/GeneFull/filtered_EM/filtered_EM <span class="at">--soloCellFilter</span> EmptyDrops_CR</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div></li>
</ul></li>
</ul>
</section>
</section>
<section id="scrna-seq-analysis-in-seurat" class="level2" data-number="2">
<h2 data-number="2" class="anchored" data-anchor-id="scrna-seq-analysis-in-seurat"><span class="header-section-number">2</span> scRNA-seq analysis in <code>Seurat</code></h2>
<section id="load-cell-x-gene-matrices" class="level3" data-number="2.1">
<h3 data-number="2.1" class="anchored" data-anchor-id="load-cell-x-gene-matrices"><span class="header-section-number">2.1</span> Load cell x gene matrices</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>path1 <span class="ot">&lt;-</span> <span class="st">"/home/chongmorrison/Dropbox/VCM-StarBook/ResearchProjects/parapineal/preprocessing/foxd3flhGFP/cellranger7.1.0_Lawson/filtered_feature_bc_matrix"</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>path2 <span class="ot">&lt;-</span> <span class="st">"/home/chongmorrison/Dropbox/VCM-StarBook/ResearchProjects/parapineal/preprocessing/foxd3flhGFP/starsolo2.7.10b_ens107/filtered_EM"</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><strong>Create <code>Seurat</code> objects and check number of cells and genes :</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>cr_law <span class="ot">&lt;-</span> <span class="fu">CreateSeuratObject</span>(<span class="fu">Read10X</span>(path1), <span class="at">project=</span><span class="st">"CellRanger-Lawson"</span>)</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>ss_e107 <span class="ot">&lt;-</span> <span class="fu">CreateSeuratObject</span>(<span class="fu">ReadSTARsolo</span>(path2), <span class="at">project=</span><span class="st">"STARsolo-ens107"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 4770 cells x 36353 genes</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ncol</span>(cr_law)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 4770</code></pre>
</div>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="fu">nrow</span>(cr_law)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 36353</code></pre>
</div>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 4536 cells x 32522 genes</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ncol</span>(ss_e107)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 4536</code></pre>
</div>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="fu">nrow</span>(ss_e107)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 32522</code></pre>
</div>
</div>
</section>
<section id="filter-genes" class="level3" data-number="2.2">
<h3 data-number="2.2" class="anchored" data-anchor-id="filter-genes"><span class="header-section-number">2.2</span> Filter genes</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Extract counts</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>counts <span class="ot">&lt;-</span> <span class="fu">LayerData</span>(cr_law, <span class="at">layer =</span> <span class="st">"counts"</span>)</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Output a logical matrix specifying for each gene on whether or not there are more than zero counts per cell</span></span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>nonzero <span class="ot">&lt;-</span> counts <span class="sc">&gt;</span> <span class="dv">0</span></span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Sums all TRUE values and returns TRUE if more than 5 TRUE values per gene</span></span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>keep_genes <span class="ot">&lt;-</span> Matrix<span class="sc">::</span><span class="fu">rowSums</span>(nonzero) <span class="sc">&gt;=</span> <span class="dv">5</span></span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Only keeping those genes expressed in more than 5 cells</span></span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a>filtered_counts <span class="ot">&lt;-</span> counts[keep_genes, ]</span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Assign to Seurat object (make new SeuratObject)</span></span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a>cr_law <span class="ot">&lt;-</span> <span class="fu">CreateSeuratObject</span>(filtered_counts, <span class="at">meta.data =</span> cr_law<span class="sc">@</span>meta.data)</span>
<span id="cb13-11"><a href="#cb13-11" aria-hidden="true" tabindex="-1"></a><span class="co"># 4770 cells x 24969 genes</span></span>
<span id="cb13-12"><a href="#cb13-12" aria-hidden="true" tabindex="-1"></a><span class="fu">ncol</span>(cr_law)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 4770</code></pre>
</div>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="fu">nrow</span>(cr_law)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 24969</code></pre>
</div>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>counts <span class="ot">&lt;-</span> <span class="fu">LayerData</span>(ss_e107, <span class="at">layer =</span> <span class="st">"counts"</span>)</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>nonzero <span class="ot">&lt;-</span> counts <span class="sc">&gt;</span> <span class="dv">0</span></span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>keep_genes <span class="ot">&lt;-</span> Matrix<span class="sc">::</span><span class="fu">rowSums</span>(nonzero) <span class="sc">&gt;=</span> <span class="dv">5</span></span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>filtered_counts <span class="ot">&lt;-</span> counts[keep_genes, ]</span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a>ss_e107 <span class="ot">&lt;-</span> <span class="fu">CreateSeuratObject</span>(filtered_counts, <span class="at">meta.data =</span> ss_e107<span class="sc">@</span>meta.data)</span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a><span class="co"># 4536 cells x 23946 genes</span></span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a><span class="fu">ncol</span>(ss_e107) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 4536</code></pre>
</div>
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="fu">nrow</span>(ss_e107)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 23946</code></pre>
</div>
</div>
</section>
<section id="compute-additional-metrics---percent.mito-ribo-complexity" class="level3" data-number="2.3">
<h3 data-number="2.3" class="anchored" data-anchor-id="compute-additional-metrics---percent.mito-ribo-complexity"><span class="header-section-number">2.3</span> Compute additional metrics - percent.mito, ribo, complexity</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>cr_law<span class="sc">$</span>percent.mt <span class="ot">&lt;-</span> <span class="fu">PercentageFeatureSet</span>(cr_law, <span class="at">pattern =</span> <span class="st">"^mt-"</span>)</span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>cr_law<span class="sc">$</span>log10GenesPerUMI <span class="ot">&lt;-</span> <span class="fu">log10</span>(cr_law<span class="sc">$</span>nFeature_RNA) <span class="sc">/</span> <span class="fu">log10</span>(cr_law<span class="sc">$</span>nCount_RNA)</span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>cr_law<span class="sc">$</span>percent.ribo <span class="ot">&lt;-</span> <span class="fu">PercentageFeatureSet</span>(cr_law, <span class="at">pattern =</span><span class="st">"^rps"</span>) <span class="sc">+</span> </span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">PercentageFeatureSet</span>(cr_law, <span class="at">pattern =</span><span class="st">"^rpl"</span>)</span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a>ss_e107<span class="sc">$</span>percent.mt <span class="ot">&lt;-</span> <span class="fu">PercentageFeatureSet</span>(ss_e107, <span class="at">pattern =</span> <span class="st">"^mt-"</span>)</span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a>ss_e107<span class="sc">$</span>log10GenesPerUMI <span class="ot">&lt;-</span> <span class="fu">log10</span>(ss_e107<span class="sc">$</span>nFeature_RNA) <span class="sc">/</span> <span class="fu">log10</span>(ss_e107<span class="sc">$</span>nCount_RNA)</span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true" tabindex="-1"></a>ss_e107<span class="sc">$</span>percent.ribo <span class="ot">&lt;-</span> <span class="fu">PercentageFeatureSet</span>(ss_e107, <span class="at">pattern =</span><span class="st">"^rps"</span>) <span class="sc">+</span> </span>
<span id="cb21-9"><a href="#cb21-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">PercentageFeatureSet</span>(ss_e107, <span class="at">pattern =</span><span class="st">"^rpl"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="compute-cell-cycle-scores" class="level3" data-number="2.4">
<h3 data-number="2.4" class="anchored" data-anchor-id="compute-cell-cycle-scores"><span class="header-section-number">2.4</span> Compute cell cycle scores</h3>
<section id="obtain-cell-cycle-genes" class="level4" data-number="2.4.1">
<h4 data-number="2.4.1" class="anchored" data-anchor-id="obtain-cell-cycle-genes"><span class="header-section-number">2.4.1</span> Obtain cell cycle genes</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>cell_cycle_genes <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="at">text =</span> RCurl<span class="sc">::</span><span class="fu">getURL</span>(<span class="st">"https://raw.githubusercontent.com/hbc/tinyatlas/master/cell_cycle/Danio_rerio.csv"</span>))</span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a><span class="co"># call in Ensembl annotations</span></span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>annotations <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">'./annotations/ensembl_annotations.csv'</span>, <span class="at">header=</span><span class="cn">TRUE</span>, <span class="at">row.names=</span><span class="dv">1</span>)</span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a><span class="co"># make a dataframe of cell cycle markers</span></span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a>cell_cycle_markers <span class="ot">&lt;-</span> dplyr<span class="sc">::</span><span class="fu">left_join</span>(cell_cycle_genes, annotations, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"geneID"</span> <span class="ot">=</span> <span class="st">"gene_id"</span>))</span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a>s_genes <span class="ot">&lt;-</span> cell_cycle_markers <span class="sc">%&gt;%</span></span>
<span id="cb22-8"><a href="#cb22-8" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(phase <span class="sc">==</span> <span class="st">"S"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb22-9"><a href="#cb22-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pull</span>(<span class="st">"gene_name"</span>)</span>
<span id="cb22-10"><a href="#cb22-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-11"><a href="#cb22-11" aria-hidden="true" tabindex="-1"></a>g2m_genes <span class="ot">&lt;-</span> cell_cycle_markers <span class="sc">%&gt;%</span></span>
<span id="cb22-12"><a href="#cb22-12" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(phase <span class="sc">==</span> <span class="st">"G2/M"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb22-13"><a href="#cb22-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pull</span>(<span class="st">"gene_name"</span>)</span>
<span id="cb22-14"><a href="#cb22-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-15"><a href="#cb22-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Remove non-zebrafish "CENPF" and "CKS2" from g2m_genes</span></span>
<span id="cb22-16"><a href="#cb22-16" aria-hidden="true" tabindex="-1"></a>g2m_genes <span class="ot">&lt;-</span> g2m_genes[<span class="sc">!</span>g2m_genes <span class="sc">==</span> <span class="fu">c</span>(<span class="st">"CENPF"</span>,<span class="st">"CKS2"</span>)]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="cell-cycle-scoring" class="level4" data-number="2.4.2">
<h4 data-number="2.4.2" class="anchored" data-anchor-id="cell-cycle-scoring"><span class="header-section-number">2.4.2</span> Cell cycle scoring</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Normalise counts for cell cycle scoring</span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>cr_law <span class="ot">&lt;-</span> <span class="fu">NormalizeData</span>(cr_law)</span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>ss_e107 <span class="ot">&lt;-</span> <span class="fu">NormalizeData</span>(ss_e107)</span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Cell cycle scoring</span></span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a>cr_law <span class="ot">&lt;-</span> <span class="fu">CellCycleScoring</span>(cr_law, <span class="at">g2m.features =</span> g2m_genes, <span class="at">s.features =</span> s_genes)</span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a>ss_e107 <span class="ot">&lt;-</span> <span class="fu">CellCycleScoring</span>(ss_e107, <span class="at">g2m.features =</span> g2m_genes, <span class="at">s.features =</span> s_genes)</span>
<span id="cb23-8"><a href="#cb23-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-9"><a href="#cb23-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Add difference between G2M and S phase scores</span></span>
<span id="cb23-10"><a href="#cb23-10" aria-hidden="true" tabindex="-1"></a>cr_law<span class="sc">$</span>CC.Difference <span class="ot">&lt;-</span> cr_law<span class="sc">$</span>S.Score <span class="sc">-</span> cr_law<span class="sc">$</span>G2M.Score</span>
<span id="cb23-11"><a href="#cb23-11" aria-hidden="true" tabindex="-1"></a>ss_e107<span class="sc">$</span>CC.Difference <span class="ot">&lt;-</span> ss_e107<span class="sc">$</span>S.Score <span class="sc">-</span> ss_e107<span class="sc">$</span>G2M.Score</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="cell-filtering" class="level3" data-number="2.5">
<h3 data-number="2.5" class="anchored" data-anchor-id="cell-filtering"><span class="header-section-number">2.5</span> Cell filtering?</h3>
<p>In a lot of cases, studies, example workflows etc. ‘poor’ quality cells are filtered out based on arbitrary metrics e.g.&nbsp;number of transcripts/genes suggestive of multiplets, high percentage mitochondrial transcripts suggestive of dying cells.</p>
<p>I judge these to be sound reasoning points…if you truly know the cellular composition of the dataset. Unlike gene-level filtering where you only make an <em>a priori</em> definition of an ‘expressed’ gene i.e.&nbsp;in at least X number of cells, cell filtering based on biological conditions dictated by the metrics mentioned above is more nuanced and (I believe) could introduce unnecessary bias and/or risk losing ‘good’ cells.</p>
<p>Therefore, for this novel dataset, I take a quasi-unbiased approach :</p>
<ul>
<li><p>Check that *most* cells are largely healthy i.e.&nbsp;percent.mt &lt; 5</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="fu">dittoPlot</span>(cr_law, <span class="st">"percent.mt"</span>, <span class="at">group.by =</span> <span class="st">"Phase"</span>,</span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>          <span class="at">vlnplot.lineweight =</span> <span class="fl">0.2</span>, <span class="at">jitter.size =</span> <span class="fl">0.3</span>,</span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>          <span class="at">main =</span> <span class="st">"PercentageFeatureSet(^mt-), cr_law"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Aim1_part1_files/figure-html/unnamed-chunk-9-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="fu">dittoPlot</span>(ss_e107, <span class="st">"percent.mt"</span>, <span class="at">group.by =</span> <span class="st">"Phase"</span>,</span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>          <span class="at">vlnplot.lineweight =</span> <span class="fl">0.2</span>, <span class="at">jitter.size =</span> <span class="fl">0.3</span>,</span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>          <span class="at">main =</span> <span class="st">"PercentageFeatureSet(^mt-), ss_e107"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Aim1_part1_files/figure-html/unnamed-chunk-10-1.png" class="img-fluid" width="672"></p>
</div>
</div></li>
<li><p>Perform dimensional reduction i.e.&nbsp;clustering on all cells, then</p>
<ul>
<li><p>Check that potential multiplets are not forming spurious clusters, and are distributed across all called clusters</p></li>
<li><p>Also check that other ‘uninteresting’ metrics are not forming spurious clusters</p></li>
</ul></li>
</ul>
</section>
</section>
<section id="dimensional-reductionclustering" class="level2" data-number="3">
<h2 data-number="3" class="anchored" data-anchor-id="dimensional-reductionclustering"><span class="header-section-number">3</span> Dimensional reduction/clustering</h2>
<section id="sctransform-normalise-find-variable-genes-regress-unwanted-variation" class="level3" data-number="3.1">
<h3 data-number="3.1" class="anchored" data-anchor-id="sctransform-normalise-find-variable-genes-regress-unwanted-variation"><span class="header-section-number">3.1</span> SCTransform (‘normalise, find variable genes, regress unwanted variation’)</h3>
<p>I previously explored the data to check if there was significant variation between the cell types driven by ribosomal/mitochondrial content and cell cycle phase. Please see <strong>Supplementary Section 1 (in progress).</strong></p>
<p>There was clear variation being driven by cell cycle phase. This was expected given a neuronal-enriched population at this developmental stage.</p>
<p>Altogether these inform the <code>SCTransform</code> parameters, where <code>CC.Difference</code> is used instead of <code>Phase</code> to maintain the separation between progenitors and non-cycling cells :</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="fu">DefaultAssay</span>(cr_law) <span class="ot">&lt;-</span> <span class="st">"RNA"</span></span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>cr_law <span class="ot">&lt;-</span> <span class="fu">SCTransform</span>(cr_law,</span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a>                     <span class="at">vars.to.regress =</span> <span class="fu">c</span>(<span class="st">"percent.ribo"</span>, <span class="st">"percent.mt"</span>, <span class="st">"CC.Difference"</span>),</span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a>                     <span class="at">vst.flavor=</span><span class="st">"v2"</span>)</span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-6"><a href="#cb26-6" aria-hidden="true" tabindex="-1"></a><span class="fu">DefaultAssay</span>(ss_e107) <span class="ot">&lt;-</span> <span class="st">"RNA"</span></span>
<span id="cb26-7"><a href="#cb26-7" aria-hidden="true" tabindex="-1"></a>ss_e107 <span class="ot">&lt;-</span> <span class="fu">SCTransform</span>(ss_e107,</span>
<span id="cb26-8"><a href="#cb26-8" aria-hidden="true" tabindex="-1"></a>                       <span class="at">vars.to.regress =</span> <span class="fu">c</span>(<span class="st">"percent.ribo"</span>, <span class="st">"percent.mt"</span>, <span class="st">"CC.Difference"</span>),</span>
<span id="cb26-9"><a href="#cb26-9" aria-hidden="true" tabindex="-1"></a>                       <span class="at">vst.flavor=</span><span class="st">"v2"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="unsupervised-clustering" class="level3" data-number="3.2">
<h3 data-number="3.2" class="anchored" data-anchor-id="unsupervised-clustering"><span class="header-section-number">3.2</span> ‘Unsupervised’ Clustering</h3>
<p>As clustering is more an art than exact science, I empirically determined the main parameters - <code>algorithm</code>, <code>npcs</code>, <code>k.param</code>, and <code>resolution</code> - and compared the result between the two pre-processing workflows/<code>Seurat</code> objects.</p>
<p><strong>‘Picking’ the number of Principal Component dimensions <code>npcs</code> :</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="fu">DefaultAssay</span>(cr_law) <span class="ot">&lt;-</span> <span class="st">"SCT"</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>cr_law <span class="ot">&lt;-</span> <span class="fu">RunPCA</span>(cr_law, <span class="at">npcs =</span> <span class="dv">60</span>)</span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a><span class="fu">ElbowPlot</span>(cr_law, <span class="at">ndims=</span><span class="dv">60</span>, <span class="at">reduction=</span><span class="st">"pca"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Aim1_part1_files/figure-html/unnamed-chunk-12-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="fu">DefaultAssay</span>(ss_e107) <span class="ot">&lt;-</span> <span class="st">"SCT"</span></span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>ss_e107 <span class="ot">&lt;-</span> <span class="fu">RunPCA</span>(ss_e107, <span class="at">npcs =</span> <span class="dv">60</span>)</span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a><span class="fu">ElbowPlot</span>(ss_e107, <span class="at">ndims=</span><span class="dv">60</span>, <span class="at">reduction=</span><span class="st">"pca"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Aim1_part1_files/figure-html/unnamed-chunk-12-2.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Based on the elbow plots above I went with <code>npcs = 40</code>. <code>k.param</code> is kept at the default <code>20</code>, and the Leiden <code>algorithm = 4</code> is selected.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>cr_law <span class="ot">&lt;-</span> <span class="fu">RunPCA</span>(cr_law, <span class="at">npcs =</span> <span class="dv">40</span>) <span class="sc">%&gt;%</span></span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">FindNeighbors</span>(<span class="at">dims =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">40</span>) <span class="sc">%&gt;%</span></span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">FindClusters</span>(<span class="at">algorithm =</span> <span class="dv">4</span>, <span class="at">resolution =</span> <span class="fu">c</span>(<span class="fl">1.0</span>), <span class="at">method=</span><span class="st">"igraph"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">RunUMAP</span>(<span class="at">dims =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">40</span>, <span class="at">n.neighbors =</span> <span class="dv">20</span>) <span class="co"># to match default k.param=20</span></span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-6"><a href="#cb29-6" aria-hidden="true" tabindex="-1"></a>ss_e107 <span class="ot">&lt;-</span> <span class="fu">RunPCA</span>(ss_e107, <span class="at">npcs =</span> <span class="dv">40</span>) <span class="sc">%&gt;%</span></span>
<span id="cb29-7"><a href="#cb29-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">FindNeighbors</span>(<span class="at">dims =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">40</span>) <span class="sc">%&gt;%</span></span>
<span id="cb29-8"><a href="#cb29-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">FindClusters</span>(<span class="at">algorithm =</span> <span class="dv">4</span>, <span class="at">resolution =</span> <span class="fu">c</span>(<span class="fl">1.0</span>), <span class="at">method=</span><span class="st">"igraph"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb29-9"><a href="#cb29-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">RunUMAP</span>(<span class="at">dims =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">40</span>, <span class="at">n.neighbors =</span> <span class="dv">20</span>) <span class="co"># to match default k.param=20</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><strong>Save <code>Seurat</code> objects to load later without re-running all the above :</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Set DefaultAssay and save objects for visualisation</span></span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a><span class="fu">DefaultAssay</span>(cr_law) <span class="ot">&lt;-</span> <span class="st">"RNA"</span></span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a>cr_law <span class="ot">&lt;-</span> <span class="fu">NormalizeData</span>(cr_law)</span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a><span class="fu">DefaultAssay</span>(ss_e107) <span class="ot">&lt;-</span> <span class="st">"RNA"</span></span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a>ss_e107 <span class="ot">&lt;-</span> <span class="fu">NormalizeData</span>(ss_e107)</span>
<span id="cb30-6"><a href="#cb30-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-7"><a href="#cb30-7" aria-hidden="true" tabindex="-1"></a><span class="fu">save</span>(cr_law, <span class="at">file=</span><span class="st">"../foxd3flh-5k_cr-law.RData"</span>)</span>
<span id="cb30-8"><a href="#cb30-8" aria-hidden="true" tabindex="-1"></a><span class="fu">save</span>(ss_e107, <span class="at">file=</span><span class="st">"../foxd3flh-5k_ss-e107.RData"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="visualise-and-explore-clustering-results-with-dittoseq" class="level2" data-number="4">
<h2 data-number="4" class="anchored" data-anchor-id="visualise-and-explore-clustering-results-with-dittoseq"><span class="header-section-number">4</span> Visualise and explore clustering results with <code>dittoSeq</code></h2>
<section id="umap-reduction" class="level3" data-number="4.1">
<h3 data-number="4.1" class="anchored" data-anchor-id="umap-reduction"><span class="header-section-number">4.1</span> UMAP reduction</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Reset DefaultAssay and Normalise counts for visualisation</span></span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a><span class="fu">DefaultAssay</span>(cr_law) <span class="ot">&lt;-</span> <span class="st">"RNA"</span></span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a>cr_law <span class="ot">&lt;-</span> <span class="fu">NormalizeData</span>(cr_law)</span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a><span class="fu">DefaultAssay</span>(ss_e107) <span class="ot">&lt;-</span> <span class="st">"RNA"</span></span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a>ss_e107 <span class="ot">&lt;-</span> <span class="fu">NormalizeData</span>(ss_e107)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="fu">dittoDimPlot</span>(cr_law, <span class="st">"SCT_snn_res.1"</span>, <span class="at">reduction.use=</span><span class="st">"umap"</span>,</span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>             <span class="at">main=</span><span class="st">"CellRanger7.1.0"</span>,</span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a>             <span class="at">sub=</span><span class="st">"Lawson2020"</span>,</span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a>             <span class="at">legend.title=</span><span class="st">"clusters"</span>,</span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a>             <span class="at">do.label=</span><span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Aim1_part1_files/figure-html/unnamed-chunk-16-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="fu">dittoDimPlot</span>(ss_e107, <span class="st">"SCT_snn_res.1"</span>, <span class="at">reduction.use=</span><span class="st">"umap"</span>,</span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>             <span class="at">main=</span><span class="st">"STARsolo2.7.10b"</span>,</span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a>             <span class="at">sub=</span><span class="st">"ensembl107"</span>,</span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a>             <span class="at">legend.title=</span><span class="st">"clusters"</span>,</span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a>             <span class="at">do.label=</span><span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Aim1_part1_files/figure-html/unnamed-chunk-17-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
</section>
<section id="identify-epiphysis-clusters" class="level2" data-number="5">
<h2 data-number="5" class="anchored" data-anchor-id="identify-epiphysis-clusters"><span class="header-section-number">5</span> Identify epiphysis clusters</h2>
<p>The epiphysis shares several of its known markers with other neuronal and/or cranial cell types. For example, <em>bsx</em> is also expressed in the hypothalamus, <em>noto</em> is also expressed in the telencephalon, and <em>otx5</em> is also expressed in the retina. Inferring the epiphysis clusters from any of these genes alone is futile:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Genes that are well known to be expressed in the epiphysis</span></span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>markers <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"bsx"</span>, <span class="st">"noto"</span>, <span class="st">"otx5"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="fu">dittoPlotVarsAcrossGroups</span>(cr_law, markers, <span class="at">group.by =</span> <span class="st">"SCT_snn_res.1"</span>,</span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a>                          <span class="at">vlnplot.lineweight =</span> <span class="fl">0.2</span>, <span class="at">jitter.size =</span> <span class="fl">0.3</span>,</span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a>                          <span class="at">main =</span> <span class="st">"cr_law (bsx/noto/otx5)"</span>, <span class="at">summary.fxn =</span> max, <span class="at">adjustment =</span> <span class="cn">NULL</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Aim1_part1_files/figure-html/unnamed-chunk-19-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="fu">dittoPlotVarsAcrossGroups</span>(ss_e107, markers, <span class="at">group.by =</span> <span class="st">"SCT_snn_res.1"</span>,</span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a>                          <span class="at">vlnplot.lineweight =</span> <span class="fl">0.2</span>, <span class="at">jitter.size =</span> <span class="fl">0.3</span>,</span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a>                          <span class="at">main =</span> <span class="st">"ss_e107 (bsx/noto/otx5)"</span>, <span class="at">summary.fxn =</span> max, <span class="at">adjustment =</span> <span class="cn">NULL</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Aim1_part1_files/figure-html/unnamed-chunk-20-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>I reasoned that, by using instead the <strong>mean</strong> expression values of these three genes combined, one could eliminate clusters that are least likely to be epiphysis cells.</p>
<p>For example, an epiphysis cell is likely to co-express bsx (1) + noto (1) + otx5 (1) = 3. Mean expression value = 3 / 3 = 1.</p>
<p>On the other hand, a retina cell would not express bsx ( &lt; 1) + noto (&lt; 1), but express + otx5 (1) = &lt; 3. Mean expression value = &lt;3 / 3 = &lt; 1.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="fu">dittoPlotVarsAcrossGroups</span>(cr_law, markers, <span class="at">group.by =</span> <span class="st">"SCT_snn_res.1"</span>,</span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a>                          <span class="at">vlnplot.lineweight =</span> <span class="fl">0.2</span>, <span class="at">jitter.size =</span> <span class="fl">0.3</span>,</span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a>                          <span class="at">main =</span> <span class="st">"cr_law (mean of bsx + noto + otx5)"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Aim1_part1_files/figure-html/unnamed-chunk-21-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="fu">dittoPlotVarsAcrossGroups</span>(ss_e107, markers, <span class="at">group.by =</span> <span class="st">"SCT_snn_res.1"</span>,</span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a>                          <span class="at">vlnplot.lineweight =</span> <span class="fl">0.2</span>, <span class="at">jitter.size =</span> <span class="fl">0.3</span>,</span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a>                          <span class="at">main =</span> <span class="st">"ss_e107 (mean of bsx + noto + otx5)"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Aim1_part1_files/figure-html/unnamed-chunk-22-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p><strong>This worked quite well, and one can appreciate two clusters-of-interest likely to be epiphysis cells.</strong> Furthermore, this observation is robust and reproducible from cell x gene matrices generated using the two dissimilar pre-processing pipelines.</p>
<ul>
<li><p><code>cr_law</code> clusters-of-interest = 2 and 18</p></li>
<li><p><code>ss_e107</code> clusters-of-interest = 2 and 19</p></li>
</ul>
<p>Let’s now look at <code>sox1a</code> that is expressed in the parapineal as it emerges from the anterior pineal region (Lekk <em>et al</em>. 2019). The following plots show that <code>sox1a</code> expression can be detected in the clusters-of-interest.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="fu">multi_dittoDimPlot</span>(cr_law, <span class="fu">c</span>(markers,<span class="st">"sox1a"</span>), <span class="at">order=</span><span class="st">"increasing"</span>, <span class="at">reduction.use=</span><span class="st">"umap"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Aim1_part1_files/figure-html/unnamed-chunk-23-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="fu">multi_dittoDimPlot</span>(ss_e107, <span class="fu">c</span>(markers,<span class="st">"sox1a"</span>), <span class="at">order=</span><span class="st">"increasing"</span>, <span class="at">reduction.use=</span><span class="st">"umap"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Aim1_part1_files/figure-html/unnamed-chunk-24-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>As both matrices consistently produced similar results so far, I am proceeding further with <code>ss_e107</code> only.</p>
<p>How many cells (roughly) are present in the clusters-of-interest? ~250 cells in total.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="fu">dittoBarPlot</span>(ss_e107, <span class="st">"SCT_snn_res.1"</span>, <span class="at">group.by =</span> <span class="st">"SCT_snn_res.1"</span>,</span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a>             <span class="at">scale =</span> <span class="st">"count"</span>,</span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a>             <span class="at">cells.use =</span> <span class="fu">meta</span>(<span class="st">"SCT_snn_res.1"</span>, ss_e107) <span class="sc">==</span> <span class="fu">c</span>(<span class="st">"2"</span>, <span class="st">"19"</span>),</span>
<span id="cb41-4"><a href="#cb41-4" aria-hidden="true" tabindex="-1"></a>             <span class="at">main=</span><span class="st">"No. of cells"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Aim1_part1_files/figure-html/unnamed-chunk-25-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="sanity-checks-on-clustering" class="level2" data-number="6">
<h2 data-number="6" class="anchored" data-anchor-id="sanity-checks-on-clustering"><span class="header-section-number">6</span> Sanity checks on clustering</h2>
<p>Remember that I did not perform <a href="#cell-filtering">Cell filtering?</a> To evaluate if the clustering afterwards was largely driven by ‘true’ biological heterogeneity, in a qualitative sense:</p>
<section id="check-distribution-of-multiplets" class="level3" data-number="6.1">
<h3 data-number="6.1" class="anchored" data-anchor-id="check-distribution-of-multiplets"><span class="header-section-number">6.1</span> Check distribution of multiplets</h3>
<p>I run <code>scDblFinder</code> to identify multiplets:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a>sce <span class="ot">&lt;-</span> <span class="fu">SingleCellExperiment</span>(</span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">assays =</span> <span class="fu">list</span>(<span class="at">counts =</span> <span class="fu">as.matrix</span>(<span class="fu">LayerData</span>(ss_e107, <span class="at">assay =</span> <span class="st">"RNA"</span>, <span class="at">layer=</span><span class="st">"counts"</span>))))</span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-4"><a href="#cb42-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(scDblFinder)</span>
<span id="cb42-5"><a href="#cb42-5" aria-hidden="true" tabindex="-1"></a>sce <span class="ot">&lt;-</span> <span class="fu">scDblFinder</span>(sce, <span class="at">clusters=</span><span class="fu">c</span>(<span class="fu">Idents</span>(ss_e107)),</span>
<span id="cb42-6"><a href="#cb42-6" aria-hidden="true" tabindex="-1"></a>                   <span class="at">BPPARAM=</span><span class="fu">MulticoreParam</span>(<span class="dv">2</span>, <span class="at">RNGseed=</span><span class="dv">1234</span>))</span>
<span id="cb42-7"><a href="#cb42-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-8"><a href="#cb42-8" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(sce<span class="sc">$</span>scDblFinder.class)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
singlet doublet 
   4167     369 </code></pre>
</div>
</div>
<p>Now port the results back to the original <code>ss_e107</code> object for visualisation. Called doublets are distributed randomly across entire dataset, which is ideal.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a>ss_e107<span class="sc">$</span>scDblFinder.class <span class="ot">&lt;-</span> sce<span class="sc">$</span>scDblFinder.class</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="fu">dittoDimPlot</span>(ss_e107, <span class="st">"scDblFinder.class"</span>, <span class="at">reduction.use=</span><span class="st">"umap"</span>,</span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a>             <span class="at">main=</span><span class="st">"STARsolo2.7.10b_ensembl107"</span>,</span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true" tabindex="-1"></a>             <span class="at">sub=</span><span class="st">"SCT_snn_res.1"</span>,</span>
<span id="cb45-4"><a href="#cb45-4" aria-hidden="true" tabindex="-1"></a>             <span class="at">legend.title=</span><span class="st">"class"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Aim1_part1_files/figure-html/unnamed-chunk-28-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="what-about-other-metrics" class="level3" data-number="6.2">
<h3 data-number="6.2" class="anchored" data-anchor-id="what-about-other-metrics"><span class="header-section-number">6.2</span> What about other metrics?</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="fu">dittoDimPlot</span>(ss_e107, <span class="st">"nCount_RNA"</span>, <span class="at">reduction.use=</span><span class="st">"umap"</span>,</span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a>             <span class="at">main=</span><span class="st">"STARsolo2.7.10b_ensembl107"</span>,</span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a>             <span class="at">sub=</span><span class="st">"SCT_snn_res.1"</span>,</span>
<span id="cb46-4"><a href="#cb46-4" aria-hidden="true" tabindex="-1"></a>             <span class="at">legend.title=</span><span class="st">"nUMI"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Aim1_part1_files/figure-html/unnamed-chunk-29-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="fu">dittoDimPlot</span>(ss_e107, <span class="st">"nFeature_RNA"</span>, <span class="at">reduction.use=</span><span class="st">"umap"</span>,</span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a>             <span class="at">main=</span><span class="st">"STARsolo2.7.10b_ensembl107"</span>,</span>
<span id="cb47-3"><a href="#cb47-3" aria-hidden="true" tabindex="-1"></a>             <span class="at">sub=</span><span class="st">"SCT_snn_res.1"</span>,</span>
<span id="cb47-4"><a href="#cb47-4" aria-hidden="true" tabindex="-1"></a>             <span class="at">legend.title=</span><span class="st">"nGenes"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Aim1_part1_files/figure-html/unnamed-chunk-30-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="fu">dittoDimPlot</span>(ss_e107, <span class="st">"percent.ribo"</span>, <span class="at">reduction.use=</span><span class="st">"umap"</span>,</span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a>             <span class="at">main=</span><span class="st">"STARsolo2.7.10b_ensembl107"</span>,</span>
<span id="cb48-3"><a href="#cb48-3" aria-hidden="true" tabindex="-1"></a>             <span class="at">sub=</span><span class="st">"SCT_snn_res.1"</span>,</span>
<span id="cb48-4"><a href="#cb48-4" aria-hidden="true" tabindex="-1"></a>             <span class="at">legend.title=</span><span class="st">"% ribosomal transcripts"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Aim1_part1_files/figure-html/unnamed-chunk-31-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="fu">dittoDimPlot</span>(ss_e107, <span class="st">"percent.mt"</span>, <span class="at">reduction.use=</span><span class="st">"umap"</span>,</span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a>             <span class="at">main=</span><span class="st">"STARsolo2.7.10b_ensembl107"</span>,</span>
<span id="cb49-3"><a href="#cb49-3" aria-hidden="true" tabindex="-1"></a>             <span class="at">sub=</span><span class="st">"SCT_snn_res.1"</span>,</span>
<span id="cb49-4"><a href="#cb49-4" aria-hidden="true" tabindex="-1"></a>             <span class="at">legend.title=</span><span class="st">"% mitochondrial transcripts"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Aim1_part1_files/figure-html/unnamed-chunk-32-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a><span class="fu">dittoDimPlot</span>(ss_e107, <span class="st">"Phase"</span>, <span class="at">reduction.use=</span><span class="st">"umap"</span>,</span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a>             <span class="at">main=</span><span class="st">"STARsolo2.7.10b_ensembl107"</span>,</span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true" tabindex="-1"></a>             <span class="at">sub=</span><span class="st">"SCT_snn_res.1"</span>,</span>
<span id="cb50-4"><a href="#cb50-4" aria-hidden="true" tabindex="-1"></a>             <span class="at">legend.title=</span><span class="st">"cell cycle"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Aim1_part1_files/figure-html/unnamed-chunk-33-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>The plots above suggests that the clusters-of-interest 2 and 19 vary from each other by cell cycle phase, and perhaps by subtle differences in the other metrics. This is something to bear in mind when interpreting results based on this clustering.</p>
<hr>
</section>
</section>
<section id="summary-notes-for-aim-1---part-1" class="level2" data-number="7">
<h2 data-number="7" class="anchored" data-anchor-id="summary-notes-for-aim-1---part-1"><span class="header-section-number">7</span> Summary notes for Aim 1 - Part 1</h2>
<ol type="1">
<li><p>Putative epiphysis cell clusters can be identified by scRNA-seq regardless of <em>sox1a</em> genotype.</p></li>
<li><p><em>Sox1a</em>-positive putative parapineal cells can be detected within these clusters.</p></li>
<li><p>Next step: <em>In vivo</em> validation of these putative clusters using imaging-based spatial transcriptomics (Vizgen MERSCOPE)</p></li>
</ol>
<hr>
</section>
<section id="references" class="level2" data-number="8">
<h2 data-number="8" class="anchored" data-anchor-id="references"><span class="header-section-number">8</span> References</h2>
<section id="packages" class="level3" data-number="8.1">
<h3 data-number="8.1" class="anchored" data-anchor-id="packages"><span class="header-section-number">8.1</span> Packages</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a>pkgs <span class="ot">&lt;-</span> <span class="fu">cite_packages</span>(<span class="at">output =</span> <span class="st">"table"</span>, <span class="at">out.dir =</span> <span class="st">"."</span>)</span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(pkgs)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: left;">Package</th>
<th style="text-align: left;">Version</th>
<th style="text-align: left;">Citation</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">base</td>
<td style="text-align: left;">4.4.2</td>
<td style="text-align: left;"><span class="citation" data-cites="base">R Core Team (<a href="#ref-base" role="doc-biblioref">2024</a>)</span></td>
</tr>
<tr class="even">
<td style="text-align: left;">BiocParallel</td>
<td style="text-align: left;">1.38.0</td>
<td style="text-align: left;"><span class="citation" data-cites="BiocPar">(<a href="#ref-BiocPar" role="doc-biblioref"><strong>BiocPar?</strong></a>)</span>….</td>
</tr>
<tr class="odd">
<td style="text-align: left;">dittoSeq</td>
<td style="text-align: left;">1.16.0</td>
<td style="text-align: left;"><span class="citation" data-cites="dittoSeq">Bunis et al. (<a href="#ref-dittoSeq" role="doc-biblioref">2020</a>)</span></td>
</tr>
<tr class="even">
<td style="text-align: left;">future</td>
<td style="text-align: left;">1.34.0</td>
<td style="text-align: left;"><span class="citation" data-cites="RJ-2021-048">Bengtsson (<a href="#ref-RJ-2021-048" role="doc-biblioref">2021</a>)</span></td>
</tr>
<tr class="odd">
<td style="text-align: left;">knitr</td>
<td style="text-align: left;">1.49</td>
<td style="text-align: left;"><span class="citation" data-cites="knitr20">(<a href="#ref-knitr20" role="doc-biblioref"><strong>knitr20?</strong></a>)</span>….</td>
</tr>
<tr class="even">
<td style="text-align: left;">Matrix</td>
<td style="text-align: left;">1.7.0</td>
<td style="text-align: left;"><span class="citation" data-cites="Matrix">Bates, Maechler, and Jagan (<a href="#ref-Matrix" role="doc-biblioref">2024</a>)</span></td>
</tr>
<tr class="odd">
<td style="text-align: left;">RCurl</td>
<td style="text-align: left;">1.98.1.16</td>
<td style="text-align: left;"><span class="citation" data-cites="RCurl">Temple Lang (<a href="#ref-RCurl" role="doc-biblioref">2024</a>)</span></td>
</tr>
<tr class="even">
<td style="text-align: left;">reticulate</td>
<td style="text-align: left;">1.40.0</td>
<td style="text-align: left;"><span class="citation" data-cites="reticulate">Ushey, Allaire, and Tang (<a href="#ref-reticulate" role="doc-biblioref">2024</a>)</span></td>
</tr>
<tr class="odd">
<td style="text-align: left;">rmarkdown</td>
<td style="text-align: left;">2.29</td>
<td style="text-align: left;"><span class="citation" data-cites="rmarkdo">(<a href="#ref-rmarkdo" role="doc-biblioref"><strong>rmarkdo?</strong></a>)</span>….</td>
</tr>
<tr class="even">
<td style="text-align: left;">scDblFinder</td>
<td style="text-align: left;">1.18.0</td>
<td style="text-align: left;"><span class="citation" data-cites="scDblFinder">Germain et al. (<a href="#ref-scDblFinder" role="doc-biblioref">2022</a>)</span></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Seurat</td>
<td style="text-align: left;">5.1.0</td>
<td style="text-align: left;"><span class="citation" data-cites="Seurat2">(<a href="#ref-Seurat2" role="doc-biblioref"><strong>Seurat2?</strong></a>)</span>….</td>
</tr>
<tr class="even">
<td style="text-align: left;">SingleCellExperiment</td>
<td style="text-align: left;">1.26.0</td>
<td style="text-align: left;"><span class="citation" data-cites="SingleC">(<a href="#ref-SingleC" role="doc-biblioref"><strong>SingleC?</strong></a>)</span>….</td>
</tr>
<tr class="odd">
<td style="text-align: left;">tidyverse</td>
<td style="text-align: left;">2.0.0</td>
<td style="text-align: left;"><span class="citation" data-cites="tidyverse">Wickham et al. (<a href="#ref-tidyverse" role="doc-biblioref">2019</a>)</span></td>
</tr>
<tr class="even">
<td style="text-align: left;">UpSetR</td>
<td style="text-align: left;">1.4.0</td>
<td style="text-align: left;"><span class="citation" data-cites="UpSetR">Gehlenborg (<a href="#ref-UpSetR" role="doc-biblioref">2019</a>)</span></td>
</tr>
</tbody>
</table>
</div>
</div>
</section>
<section id="previous-work" class="level3" data-number="8.2">
<h3 data-number="8.2" class="anchored" data-anchor-id="previous-work"><span class="header-section-number">8.2</span> Previous work</h3>
<ul>
<li>Mary Piper, Meeta Mistry, Jihe Liu, William Gammerdinger, &amp; Radhika Khetani. (2022, January 6). hbctraining/scRNA-seq_online: scRNA-seq Lessons from HCBC (first release). Zenodo. <a href="https://doi.org/10.5281/zenodo.5826256" class="uri">https://doi.org/10.5281/zenodo.5826256</a>.</li>
<li>I. Lekk, V. Duboc, A. Faro, S. Nicolaou, P. Blader and S.W. Wilson. <em>Sox1a mediates the ability of the parapineal to impart habenular left-right asymmetry</em>. eLife (2019), e47376, 8, <a href="https://doi.org/10.7554/eLife.47376" class="uri">https://doi.org/10.7554/eLife.47376</a></li>
<li><a href="https://www.umassmed.edu/lawson-lab/reagents/zebrafish-transcriptome/">Lawson Lab zebrafish transcriptome annotation</a></li>
</ul>
</section>
</section>
<section id="session-info" class="level2" data-number="9">
<h2 data-number="9" class="anchored" data-anchor-id="session-info"><span class="header-section-number">9</span> Session Info</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sessionInfo</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>R version 4.4.2 (2024-10-31)
Platform: x86_64-pc-linux-gnu
Running under: Ubuntu 22.04.5 LTS

Matrix products: default
BLAS:   /usr/lib/x86_64-linux-gnu/blas/libblas.so.3.10.0 
LAPACK: /usr/lib/x86_64-linux-gnu/lapack/liblapack.so.3.10.0

locale:
 [1] LC_CTYPE=en_GB.UTF-8       LC_NUMERIC=C              
 [3] LC_TIME=en_GB.UTF-8        LC_COLLATE=en_GB.UTF-8    
 [5] LC_MONETARY=en_GB.UTF-8    LC_MESSAGES=en_GB.UTF-8   
 [7] LC_PAPER=en_GB.UTF-8       LC_NAME=C                 
 [9] LC_ADDRESS=C               LC_TELEPHONE=C            
[11] LC_MEASUREMENT=en_GB.UTF-8 LC_IDENTIFICATION=C       

time zone: Europe/London
tzcode source: system (glibc)

attached base packages:
[1] stats4    stats     graphics  grDevices utils     datasets  methods  
[8] base     

other attached packages:
 [1] scDblFinder_1.18.0          grateful_0.2.10            
 [3] SingleCellExperiment_1.26.0 SummarizedExperiment_1.34.0
 [5] Biobase_2.64.0              GenomicRanges_1.56.2       
 [7] GenomeInfoDb_1.40.1         IRanges_2.38.1             
 [9] S4Vectors_0.42.1            BiocGenerics_0.50.0        
[11] MatrixGenerics_1.16.0       matrixStats_1.4.1          
[13] dittoSeq_1.16.0             lubridate_1.9.3            
[15] forcats_1.0.0               stringr_1.5.1              
[17] dplyr_1.1.4                 purrr_1.0.2                
[19] readr_2.1.5                 tidyr_1.3.1                
[21] tibble_3.2.1                ggplot2_3.5.1              
[23] tidyverse_2.0.0             Seurat_5.1.0               
[25] SeuratObject_5.0.2          sp_2.1-4                   
[27] reticulate_1.40.0           BiocParallel_1.38.0        
[29] future_1.34.0              

loaded via a namespace (and not attached):
  [1] RcppAnnoy_0.0.22          splines_4.4.2            
  [3] later_1.3.2               BiocIO_1.14.0            
  [5] bitops_1.0-9              polyclip_1.10-7          
  [7] XML_3.99-0.17             fastDummies_1.7.4        
  [9] lifecycle_1.0.4           edgeR_4.2.2              
 [11] globals_0.16.3            lattice_0.22-6           
 [13] MASS_7.3-61               magrittr_2.0.3           
 [15] limma_3.60.6              plotly_4.10.4            
 [17] rmarkdown_2.29            yaml_2.3.10              
 [19] metapod_1.12.0            httpuv_1.6.15            
 [21] glmGamPoi_1.16.0          sctransform_0.4.1        
 [23] spam_2.11-0               spatstat.sparse_3.1-0    
 [25] cowplot_1.1.3             pbapply_1.7-2            
 [27] RColorBrewer_1.1-3        abind_1.4-8              
 [29] zlibbioc_1.50.0           Rtsne_0.17               
 [31] RCurl_1.98-1.16           rappdirs_0.3.3           
 [33] GenomeInfoDbData_1.2.12   ggrepel_0.9.6            
 [35] irlba_2.3.5.1             listenv_0.9.1            
 [37] spatstat.utils_3.1-1      pheatmap_1.0.12          
 [39] goftest_1.2-3             RSpectra_0.16-2          
 [41] dqrng_0.4.1               spatstat.random_3.3-2    
 [43] fitdistrplus_1.2-1        parallelly_1.39.0        
 [45] DelayedMatrixStats_1.26.0 leiden_0.4.3.1           
 [47] codetools_0.2-20          DelayedArray_0.30.1      
 [49] scuttle_1.14.0            tidyselect_1.2.1         
 [51] UCSC.utils_1.0.0          farver_2.1.2             
 [53] viridis_0.6.5             ScaledMatrix_1.12.0      
 [55] spatstat.explore_3.3-3    GenomicAlignments_1.40.0 
 [57] jsonlite_1.8.9            BiocNeighbors_1.22.0     
 [59] progressr_0.15.0          scater_1.32.1            
 [61] ggridges_0.5.6            survival_3.7-0           
 [63] tools_4.4.2               ica_1.0-3                
 [65] Rcpp_1.0.13-1             glue_1.8.0               
 [67] gridExtra_2.3             SparseArray_1.4.8        
 [69] xfun_0.49                 withr_3.0.2              
 [71] fastmap_1.2.0             bluster_1.14.0           
 [73] fansi_1.0.6               rsvd_1.0.5               
 [75] digest_0.6.37             timechange_0.3.0         
 [77] R6_2.5.1                  mime_0.12                
 [79] colorspace_2.1-1          scattermore_1.2          
 [81] tensor_1.5                spatstat.data_3.1-2      
 [83] utf8_1.2.4                generics_0.1.3           
 [85] renv_1.0.11               data.table_1.16.2        
 [87] rtracklayer_1.64.0        httr_1.4.7               
 [89] htmlwidgets_1.6.4         S4Arrays_1.4.1           
 [91] uwot_0.2.2                pkgconfig_2.0.3          
 [93] gtable_0.3.6              lmtest_0.9-40            
 [95] XVector_0.44.0            htmltools_0.5.8.1        
 [97] dotCall64_1.2             scales_1.3.0             
 [99] png_0.1-8                 spatstat.univar_3.1-1    
[101] scran_1.32.0              knitr_1.49               
[103] rstudioapi_0.17.1         rjson_0.2.23             
[105] tzdb_0.4.0                reshape2_1.4.4           
[107] curl_6.0.1                nlme_3.1-165             
[109] zoo_1.8-12                KernSmooth_2.23-24       
[111] vipor_0.4.7               parallel_4.4.2           
[113] miniUI_0.1.1.1            restfulr_0.0.15          
[115] pillar_1.9.0              grid_4.4.2               
[117] vctrs_0.6.5               RANN_2.6.2               
[119] promises_1.3.0            BiocSingular_1.20.0      
[121] beachmat_2.20.0           xtable_1.8-4             
[123] cluster_2.1.6             beeswarm_0.4.0           
[125] evaluate_1.0.1            locfit_1.5-9.10          
[127] Rsamtools_2.20.0          cli_3.6.3                
[129] compiler_4.4.2            rlang_1.1.4              
[131] crayon_1.5.3              future.apply_1.11.3      
[133] labeling_0.4.3            ggbeeswarm_0.7.2         
[135] plyr_1.8.9                stringi_1.8.4            
[137] viridisLite_0.4.2         deldir_2.0-4             
[139] Biostrings_2.72.1         munsell_0.5.1            
[141] lazyeval_0.2.2            spatstat.geom_3.3-3      
[143] Matrix_1.7-0              RcppHNSW_0.6.0           
[145] hms_1.1.3                 patchwork_1.3.0          
[147] sparseMatrixStats_1.16.0  statmod_1.5.0            
[149] shiny_1.9.1               ROCR_1.0-11              
[151] igraph_2.1.1              xgboost_1.7.8.1          </code></pre>
</div>
</div>



</section>

<div id="quarto-appendix" class="default"><section class="quarto-appendix-contents" role="doc-bibliography"><h2 class="anchored quarto-appendix-heading">References</h2><div id="refs" class="references csl-bib-body hanging-indent" role="list">
<div id="ref-Matrix" class="csl-entry" role="listitem">
Bates, Douglas, Martin Maechler, and Mikael Jagan. 2024. <em><span>Matrix</span>: Sparse and Dense Matrix Classes and Methods</em>. <a href="https://CRAN.R-project.org/package=Matrix">https://CRAN.R-project.org/package=Matrix</a>.
</div>
<div id="ref-RJ-2021-048" class="csl-entry" role="listitem">
Bengtsson, Henrik. 2021. <span>“A Unifying Framework for Parallel and Distributed Processing in r Using Futures.”</span> <em>The R Journal</em> 13 (2): 208–27. <a href="https://doi.org/10.32614/RJ-2021-048">https://doi.org/10.32614/RJ-2021-048</a>.
</div>
<div id="ref-dittoSeq" class="csl-entry" role="listitem">
Bunis, Daniel G., Jared Andrews, Gabriela K. Fragiadakis, Trevor D. Burt, and Marina Sirota. 2020. <span>“<span class="nocase">dittoSeq</span>: Universal User-Friendly Single-Cell and Bulk RNA Sequencing Visualization Toolkit.”</span> <em>Bioinformatics</em>, no. 22-23 (December): 5535–36. <a href="https://doi.org/10.1093/bioinformatics/btaa1011">https://doi.org/10.1093/bioinformatics/btaa1011</a>.
</div>
<div id="ref-UpSetR" class="csl-entry" role="listitem">
Gehlenborg, Nils. 2019. <em><span>UpSetR</span>: A More Scalable Alternative to Venn and Euler Diagrams for Visualizing Intersecting Sets</em>. <a href="https://CRAN.R-project.org/package=UpSetR">https://CRAN.R-project.org/package=UpSetR</a>.
</div>
<div id="ref-scDblFinder" class="csl-entry" role="listitem">
Germain, Pierre-Luc, Aaron Lun, Carlos Garcia Meixide, Will Macnair, and Mark D. Robinson. 2022. <span>“Doublet Identification in Single-Cell Sequencing Data Using scDblFinder.”</span> <em>F1000research</em>. <a href="https://doi.org/10.12688/f1000research.73600.2">https://doi.org/10.12688/f1000research.73600.2</a>.
</div>
<div id="ref-base" class="csl-entry" role="listitem">
R Core Team. 2024. <em><span>R</span>: A Language and Environment for Statistical Computing</em>. Vienna, Austria: R Foundation for Statistical Computing. <a href="https://www.R-project.org/">https://www.R-project.org/</a>.
</div>
<div id="ref-RCurl" class="csl-entry" role="listitem">
Temple Lang, Duncan. 2024. <em><span>RCurl</span>: General Network (HTTP/FTP/...) Client Interface for r</em>. <a href="https://CRAN.R-project.org/package=RCurl">https://CRAN.R-project.org/package=RCurl</a>.
</div>
<div id="ref-reticulate" class="csl-entry" role="listitem">
Ushey, Kevin, JJ Allaire, and Yuan Tang. 2024. <em><span class="nocase">reticulate</span>: Interface to <span>“<span>Python</span>”</span></em>. <a href="https://CRAN.R-project.org/package=reticulate">https://CRAN.R-project.org/package=reticulate</a>.
</div>
<div id="ref-tidyverse" class="csl-entry" role="listitem">
Wickham, Hadley, Mara Averick, Jennifer Bryan, Winston Chang, Lucy D’Agostino McGowan, Romain François, Garrett Grolemund, et al. 2019. <span>“Welcome to the <span class="nocase">tidyverse</span>.”</span> <em>Journal of Open Source Software</em> 4 (43): 1686. <a href="https://doi.org/10.21105/joss.01686">https://doi.org/10.21105/joss.01686</a>.
</div>
</div></section></div></main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<script src="https://utteranc.es/client.js" repo="zfBrainAsymmetry/comments" issue-term="pathname" theme="github-light" crossorigin="anonymous" async="">
</script>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
      &nbsp;
    </div>   
    <div class="nav-footer-center">Copyright 2024, Vanessa Chong-Morrison</div>
    <div class="nav-footer-right">
      &nbsp;
    </div>
  </div>
</footer>



</body></html>